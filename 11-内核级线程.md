### 内核级线程
---
- 进程在内核中
- 实际上切换进程时切换内核级线程
- 切换用户级线程是切换内核级线程的一部分
- 用户栈和内核栈的区别 ？
> threadcreate是系统调用 内核管理TCB 内核负责切换线程
- 如何让切换成型 ?
> 内核栈 TCB
- 用户是否还要使用 ? 
> 执行的代码仍在用户态 还要进行函数调用
- 一个栈到一套栈 两个栈到两套栈
- TCB关联内核栈
---
- 用户栈和内核栈的关联 ?
> 用户栈和内核栈之间通过INT IRET进行压栈出栈操作 
> 从而实现内核级中的一套栈
> 所有中断 始终 外设 INT都引起上述切换
> 中断与一次帮助了操作系统

> 用户栈
>> 104
>> 204
---
> 内核栈
>> SS:SP
>> EFLAGS
>> 304
>> CS
>> 1000
---
> 中断返回
---
> 内核中的切换 switch_to()
> 通过TCB找到内核栈指针 然后通过ret切到某个结合程序
> 最后再用CS:PC切到用户程序
---
- 内核线程switch_to五段论
1. 中断入口 进入切换
2. 中段处理 引发切换
3. 进入内核栈
4. 内核栈切换
5. 中断出口 第二级切换
> S T非同一进程 地址切换
- 用户级线程 核心级线程对比



















